"0","options(scipen=10000)"
"0",""
"0","com_location_counts <- ds_salary_data %>% "
"0","  count(company_location) %>% "
"0","  arrange(desc(n)) %>% "
"0","  filter(n > 15)"
"0",""
"0","write.csv(com_location_counts, file = ""output/com_Location_counts.csv"")"
"0",""
"0","used_data_plot3 <- ds_salary_data %>% "
"0","  filter(com_location_counts$company_location == company_location)  %>% "
"0","  mutate(cp_loc = ifelse(company_location == ""US"", ""United States"",ifelse(company_location == ""CA"", ""Canada"", ifelse(company_location == ""GB"", ""United Kingdom"", ifelse(company_location == ""IN"", ""India"", ""Germany""))))) %>% "
"0","  mutate(remote = ifelse(remote_ratio == 0, ""less than 20% remote workers"", ifelse(remote_ratio == 50, ""greater than 20% but less than 80% remote workers"", ""greater than 80% remote workers"")))"
"0",""
"0","write.csv(used_data_plot3, file = ""output/used_data_plot3.csv"")"
"0",""
"0","plot4 <-  used_data_plot3 %>% "
"0","    ggplot(aes(x = fct_rev(fct_infreq(cp_loc)))) +"
"0","    geom_bar(colour = ""black"", fill = ""lightgrey"") + "
"0","  coord_flip()+"
"0","  theme_bw() +"
"0","  labs("
"0","    title = ""Countries Above The 15 Job Threshold"","
"0","    y = ""Number of Salaries Paid"","
"0","    x = """""
"0","  ) + "
"0","  theme("
"0","    axis.text = element_text(size = 20),"
"0","    plot.title = element_text(hjust = 0.5, face = ""bold"", vjust = 3, size = 20),"
"0","    axis.text.y = element_text(vjust = 0),"
"0","    axis.title = element_text(face = ""bold"", size = 15),"
"0","    plot.margin = margin(25,25,25,25),"
"0","  ) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(0,70))"
"0",""
"0","ggsave(""figs/plot3_1.png"", plot = plot4)"
"0",""
"0",""
"0","med_us_data <- used_data_plot3 %>% "
"0","  filter(cp_loc == ""United States"") %>% "
"0","  group_by(remote) %>% "
"0","  summarise(sal_med = median(salary_in_usd), sd = sd(salary_in_usd), len = length(salary_in_usd)) %>% "
"0","  mutate(se = sd / sqrt(len)) %>% "
"0","  mutate(CI99 = 2.576*se) %>% "
"0","  mutate(y_loc = runif(3, 0.000002, 0.000007))"
"0",""
"0","write.csv(med_us_data, file = ""output/med_us_data.csv"")"
"0",""
"0","plot5 <- used_data_plot3 %>% "
"0","  filter(cp_loc == ""United States"") %>% "
"0","  ggplot(aes(x = salary_in_usd)) +"
"0","  geom_density(aes(colour = fct_relevel(remote, ""less than 20% remote workers"", ""greater than 20% but less than 80% remote workers"", ""greater than 80% remote workers"")), fill = ""lightgrey"", stat = ""density"", linewidth = 1.5) +"
"0","  theme_bw() +"
"0","  labs("
"0","    title = ""Differences in Salary When it Comes to Remote Work in The United States"","
"0","    y = ""Density of Salaries Paid"","
"0","    x = ""Salary (USD)"","
"0","    colour = ""Remote Work"","
"0","    caption = ""The median is shown by the same coloured line in each distribution"""
"0","  ) + "
"0","  scale_colour_OkabeIto() +"
"0","  geom_vline(data=med_us_data, aes(xintercept=sal_med, colour= fct_relevel(remote, ""less than 20% remote workers"", ""greater than 20% but less than 80% remote workers"", ""greater than 80% remote workers"")),"
"0","             linetype=""dashed"", size=1) +"
"0","  geom_text(data = med_us_data, aes(label = sal_med, y=y_loc, x=sal_med, colour = fct_relevel(remote, ""less than 20% remote workers"", ""greater than 20% but less than 80% remote workers"", ""greater than 80% remote workers"")), size = 5) +"
"0","  theme("
"0","    plot.title = element_text(hjust = 0.5, face = ""bold"", vjust = 3),"
"0","    axis.text.y = element_text(vjust = 0),"
"0","    axis.title = element_text(face = ""bold""),"
"0","    legend.title = element_text(face = ""bold""),"
"0","    legend.background = element_rect(colour = ""black""),"
"0","    legend.margin = margin(10,10,10,10),"
"0","    plot.margin = margin(25,25,25,25),"
"0","    plot.caption = element_text(hjust = 0.5, face = ""bold"", vjust = 3)"
"0","  )"
"0",""
"0","median_country_data <- used_data_plot3 %>% "
"0","  group_by(cp_loc) %>% "
"0","  summarize(salary_in_usd_median = median(salary_in_usd), sd = sd(salary_in_usd), len = length(salary_in_usd)) %>% "
"0","  mutate(se = sd / sqrt(len)) %>% "
"0","  mutate(CI99 = 2.576*se)"
"0",""
"0","write.csv(median_country_data, file = ""output/median_country_data.csv"")"
"0",""
"0","plot6 <- used_data_plot3 %>% "
"0","  ggplot(aes(x = fct_relevel(cp_loc, ""Germany"", ""Canada"", ""India"", ""United Kingdom"", ""United States""), y = salary_in_usd)) +"
"0","  geom_violin(fill = ""lightgrey"") +"
"0","  stat_boxplot(geom = ""errorbar"", linewidth = 1, width = 0.2) +"
"0","  geom_boxplot(colour = ""black"", width = 0.07, linewidth = 0.5) +"
"0","  geom_boxplot(data = median_country_data, aes(x = cp_loc, y = salary_in_usd_median), width = 0.2) +"
"0","  coord_flip() +"
"0","  theme_bw() +"
"0","  labs("
"0","    title = ""Differences in Salary When it Comes to Company Location"","
"0","    y = ""Salary (USD)"","
"0","    x = """""
"0","  ) + "
"0","  scale_fill_discrete_qualitative(palette = ""Dark3"") +"
"0","  theme("
"0","    axis.text = element_text(size = 20),"
"0","    plot.title = element_text(hjust = 0.5, face = ""bold"", vjust = 3, size = 20),"
"0","    axis.text.y = element_text(vjust = 0),"
"0","    axis.title = element_text(face = ""bold"", size = 15),"
"0","    plot.margin = margin(25,25,25,25)"
"0","  )"
"0",""
"0","ggsave(""figs/plot3_2.png"", plot = plot6)"
"0",""
"0","anim <- plot5 + transition_states(fct_relevel(remote, ""less than 20% remote workers"", ""greater than 20% but less than 80% remote workers"", ""greater than 80% remote workers""), transition_length = 2, state_length = 1) +"
"0","             enter_fade() +"
"0","             exit_fade() +"
"0","             shadow_trail(fill = ""white"", size = 0.75, past = FALSE, future = TRUE) +"
"0","             ggtitle(""Differences in Salary When it Comes to Remote Work in The United States"" , subtitle = ""Now showing companies with {closest_state}"")"
"0",""
"0","animate(anim, duration = 8, fps = 30, width = 800, height = 400, renderer = gifski_renderer())"
"2","Inserting image 1 at 0.00s (0%)..."
"2","Inserting image 2 at 0.03s (0%)..."
"2","Inserting image 3 at 0.07s (1%)..."
"2","Inserting image 4 at 0.10s (1%)..."
"2","Inserting image 5 at 0.13s (2%)..."
"2","Inserting image 6 at 0.17s (2%)..."
"2","Inserting image 7 at 0.20s (2%)..."
"2","Inserting image 8 at 0.23s (3%)..."
"2","Inserting image 9 at 0.27s (3%)..."
"2","Inserting image 10 at 0.30s (4%)..."
"2","Inserting image 11 at 0.33s (4%)..."
"2","Inserting image 12 at 0.37s (5%)..."
"2","Inserting image 13 at 0.40s (5%)..."
"2","Inserting image 14 at 0.43s (5%)..."
"2","Inserting image 15 at 0.47s (6%)..."
"2","Inserting image 16 at 0.50s (6%)..."
"2","Inserting image 17 at 0.53s (7%)..."
"2","Inserting image 18 at 0.57s (7%)..."
"2","Inserting image 19 at 0.60s (7%)..."
"2","Inserting image 20 at 0.63s (8%)..."
"2","Inserting image 21 at 0.67s (8%)..."
"2","Inserting image 22 at 0.70s (9%)..."
"2","Inserting image 23 at 0.73s (9%)..."
"2","Inserting image 24 at 0.77s (10%)..."
"2","Inserting image 25 at 0.80s (10%)..."
"2","Inserting image 26 at 0.83s (10%)..."
"2","Inserting image 27 at 0.87s (11%)..."
"2","Inserting image 28 at 0.90s (11%)..."
"2","Inserting image 29 at 0.93s (12%)..."
"2","Inserting image 30 at 0.97s (12%)..."
"2","Inserting image 31 at 1.00s (12%)..."
"2","Inserting image 32 at 1.03s (13%)..."
"2","Inserting image 33 at 1.07s (13%)..."
"2","Inserting image 34 at 1.10s (14%)..."
"2","Inserting image 35 at 1.13s (14%)..."
"2","Inserting image 36 at 1.17s (15%)..."
"2","Inserting image 37 at 1.20s (15%)..."
"2","Inserting image 38 at 1.23s (15%)..."
"2","Inserting image 39 at 1.27s (16%)..."
"2","Inserting image 40 at 1.30s (16%)..."
"2","Inserting image 41 at 1.33s (17%)..."
"2","Inserting image 42 at 1.37s (17%)..."
"2","Inserting image 43 at 1.40s (17%)..."
"2","Inserting image 44 at 1.43s (18%)..."
"2","Inserting image 45 at 1.47s (18%)..."
"2","Inserting image 46 at 1.50s (19%)..."
"2","Inserting image 47 at 1.53s (19%)..."
"2","Inserting image 48 at 1.57s (20%)..."
"2","Inserting image 49 at 1.60s (20%)..."
"2","Inserting image 50 at 1.63s (20%)..."
"2","Inserting image 51 at 1.67s (21%)..."
"2","Inserting image 52 at 1.70s (21%)..."
"2","Inserting image 53 at 1.73s (22%)..."
"2","Inserting image 54 at 1.77s (22%)..."
"2","Inserting image 55 at 1.80s (22%)..."
"2","Inserting image 56 at 1.83s (23%)..."
"2","Inserting image 57 at 1.87s (23%)..."
"2","Inserting image 58 at 1.90s (24%)..."
"2","Inserting image 59 at 1.93s (24%)..."
"2","Inserting image 60 at 1.97s (25%)..."
"2","Inserting image 61 at 2.00s (25%)..."
"2","Inserting image 62 at 2.03s (25%)..."
"2","Inserting image 63 at 2.07s (26%)..."
"2","Inserting image 64 at 2.10s (26%)..."
"2","Inserting image 65 at 2.13s (27%)..."
"2","Inserting image 66 at 2.17s (27%)..."
"2","Inserting image 67 at 2.20s (27%)..."
"2","Inserting image 68 at 2.23s (28%)..."
"2","Inserting image 69 at 2.27s (28%)..."
"2","Inserting image 70 at 2.30s (29%)..."
"2","Inserting image 71 at 2.33s (29%)..."
"2","Inserting image 72 at 2.37s (30%)..."
"2","Inserting image 73 at 2.40s (30%)..."
"2","Inserting image 74 at 2.43s (30%)..."
"2","Inserting image 75 at 2.47s (31%)..."
"2","Inserting image 76 at 2.50s (31%)..."
"2","Inserting image 77 at 2.53s (32%)..."
"2","Inserting image 78 at 2.57s (32%)..."
"2","Inserting image 79 at 2.60s (32%)..."
"2","Inserting image 80 at 2.63s (33%)..."
"2","Inserting image 81 at 2.67s (33%)..."
"2","Inserting image 82 at 2.70s (34%)..."
"2","Inserting image 83 at 2.73s (34%)..."
"2","Inserting image 84 at 2.77s (35%)..."
"2","Inserting image 85 at 2.80s (35%)..."
"2","Inserting image 86 at 2.83s (35%)..."
"2","Inserting image 87 at 2.87s (36%)..."
"2","Inserting image 88 at 2.90s (36%)..."
"2","Inserting image 89 at 2.93s (37%)..."
"2","Inserting image 90 at 2.97s (37%)..."
"2","Inserting image 91 at 3.00s (37%)..."
"2","Inserting image 92 at 3.03s (38%)..."
"2","Inserting image 93 at 3.07s (38%)..."
"2","Inserting image 94 at 3.10s (39%)..."
"2","Inserting image 95 at 3.13s (39%)..."
"2","Inserting image 96 at 3.17s (40%)..."
"2","Inserting image 97 at 3.20s (40%)..."
"2","Inserting image 98 at 3.23s (40%)..."
"2","Inserting image 99 at 3.27s (41%)..."
"2","Inserting image 100 at 3.30s (41%)..."
"2","Inserting image 101 at 3.33s (42%)..."
"2","Inserting image 102 at 3.37s (42%)..."
"2","Inserting image 103 at 3.40s (42%)..."
"2","Inserting image 104 at 3.43s (43%)..."
"2","Inserting image 105 at 3.47s (43%)..."
"2","Inserting image 106 at 3.50s (44%)..."
"2","Inserting image 107 at 3.53s (44%)..."
"2","Inserting image 108 at 3.57s (45%)..."
"2","Inserting image 109 at 3.60s (45%)..."
"2","Inserting image 110 at 3.63s (45%)..."
"2","Inserting image 111 at 3.67s (46%)..."
"2","Inserting image 112 at 3.70s (46%)..."
"2","Inserting image 113 at 3.73s (47%)..."
"2","Inserting image 114 at 3.77s (47%)..."
"2","Inserting image 115 at 3.80s (47%)..."
"2","Inserting image 116 at 3.83s (48%)..."
"2","Inserting image 117 at 3.87s (48%)..."
"2","Inserting image 118 at 3.90s (49%)..."
"2","Inserting image 119 at 3.93s (49%)..."
"2","Inserting image 120 at 3.97s (50%)..."
"2","Inserting image 121 at 4.00s (50%)..."
"2","Inserting image 122 at 4.03s (50%)..."
"2","Inserting image 123 at 4.07s (51%)..."
"2","Inserting image 124 at 4.10s (51%)..."
"2","Inserting image 125 at 4.13s (52%)..."
"2","Inserting image 126 at 4.17s (52%)..."
"2","Inserting image 127 at 4.20s (52%)..."
"2","Inserting image 128 at 4.23s (53%)..."
"2","Inserting image 129 at 4.27s (53%)..."
"2","Inserting image 130 at 4.30s (54%)..."
"2","Inserting image 131 at 4.33s (54%)..."
"2","Inserting image 132 at 4.37s (55%)..."
"2","Inserting image 133 at 4.40s (55%)..."
"2","Inserting image 134 at 4.43s (55%)..."
"2","Inserting image 135 at 4.47s (56%)..."
"2","Inserting image 136 at 4.50s (56%)..."
"2","Inserting image 137 at 4.53s (57%)..."
"2","Inserting image 138 at 4.57s (57%)..."
"2","Inserting image 139 at 4.60s (57%)..."
"2","Inserting image 140 at 4.63s (58%)..."
"2","Inserting image 141 at 4.67s (58%)..."
"2","Inserting image 142 at 4.70s (59%)..."
"2","Inserting image 143 at 4.73s (59%)..."
"2","Inserting image 144 at 4.77s (60%)..."
"2","Inserting image 145 at 4.80s (60%)..."
"2","Inserting image 146 at 4.83s (60%)..."
"2","Inserting image 147 at 4.87s (61%)..."
"2","Inserting image 148 at 4.90s (61%)..."
"2","Inserting image 149 at 4.93s (62%)..."
"2","Inserting image 150 at 4.97s (62%)..."
"2","Inserting image 151 at 5.00s (62%)..."
"2","Inserting image 152 at 5.03s (63%)..."
"2","Inserting image 153 at 5.07s (63%)..."
"2","Inserting image 154 at 5.10s (64%)..."
"2","Inserting image 155 at 5.13s (64%)..."
"2","Inserting image 156 at 5.17s (65%)..."
"2","Inserting image 157 at 5.20s (65%)..."
"2","Inserting image 158 at 5.23s (65%)..."
"2","Inserting image 159 at 5.27s (66%)..."
"2","Inserting image 160 at 5.30s (66%)..."
"2","Inserting image 161 at 5.33s (67%)..."
"2","Inserting image 162 at 5.37s (67%)..."
"2","Inserting image 163 at 5.40s (67%)..."
"2","Inserting image 164 at 5.43s (68%)..."
"2","Inserting image 165 at 5.47s (68%)..."
"2","Inserting image 166 at 5.50s (69%)..."
"2","Inserting image 167 at 5.53s (69%)..."
"2","Inserting image 168 at 5.57s (70%)..."
"2","Inserting image 169 at 5.60s (70%)..."
"2","Inserting image 170 at 5.63s (70%)..."
"2","Inserting image 171 at 5.67s (71%)..."
"2","Inserting image 172 at 5.70s (71%)..."
"2","Inserting image 173 at 5.73s (72%)..."
"2","Inserting image 174 at 5.77s (72%)..."
"2","Inserting image 175 at 5.80s (72%)..."
"2","Inserting image 176 at 5.83s (73%)..."
"2","Inserting image 177 at 5.87s (73%)..."
"2","Inserting image 178 at 5.90s (74%)..."
"2","Inserting image 179 at 5.93s (74%)..."
"2","Inserting image 180 at 5.97s (75%)..."
"2","Inserting image 181 at 6.00s (75%)..."
"2","Inserting image 182 at 6.03s (75%)..."
"2","Inserting image 183 at 6.07s (76%)..."
"2","Inserting image 184 at 6.10s (76%)..."
"2","Inserting image 185 at 6.13s (77%)..."
"2","Inserting image 186 at 6.17s (77%)..."
"2","Inserting image 187 at 6.20s (77%)..."
"2","Inserting image 188 at 6.23s (78%)..."
"2","Inserting image 189 at 6.27s (78%)..."
"2","Inserting image 190 at 6.30s (79%)..."
"2","Inserting image 191 at 6.33s (79%)..."
"2","Inserting image 192 at 6.37s (80%)..."
"2","Inserting image 193 at 6.40s (80%)..."
"2","Inserting image 194 at 6.43s (80%)..."
"2","Inserting image 195 at 6.47s (81%)..."
"2","Inserting image 196 at 6.50s (81%)..."
"2","Inserting image 197 at 6.53s (82%)..."
"2","Inserting image 198 at 6.57s (82%)..."
"2","Inserting image 199 at 6.60s (82%)..."
"2","Inserting image 200 at 6.63s (83%)..."
"2","Inserting image 201 at 6.67s (83%)..."
"2","Inserting image 202 at 6.70s (84%)..."
"2","Inserting image 203 at 6.73s (84%)..."
"2","Inserting image 204 at 6.77s (85%)..."
"2","Inserting image 205 at 6.80s (85%)..."
"2","Inserting image 206 at 6.83s (85%)..."
"2","Inserting image 207 at 6.87s (86%)..."
"2","Inserting image 208 at 6.90s (86%)..."
"2","Inserting image 209 at 6.93s (87%)..."
"2","Inserting image 210 at 6.97s (87%)..."
"2","Inserting image 211 at 7.00s (87%)..."
"2","Inserting image 212 at 7.03s (88%)..."
"2","Inserting image 213 at 7.07s (88%)..."
"2","Inserting image 214 at 7.10s (89%)..."
"2","Inserting image 215 at 7.13s (89%)..."
"2","Inserting image 216 at 7.17s (90%)..."
"2","Inserting image 217 at 7.20s (90%)..."
"2","Inserting image 218 at 7.23s (90%)..."
"2","Inserting image 219 at 7.27s (91%)..."
"2","Inserting image 220 at 7.30s (91%)..."
"2","Inserting image 221 at 7.33s (92%)..."
"2","Inserting image 222 at 7.37s (92%)..."
"2","Inserting image 223 at 7.40s (92%)..."
"2","Inserting image 224 at 7.43s (93%)..."
"2","Inserting image 225 at 7.47s (93%)..."
"2","Inserting image 226 at 7.50s (94%)..."
"2","Inserting image 227 at 7.53s (94%)..."
"2","Inserting image 228 at 7.57s (95%)..."
"2","Inserting image 229 at 7.60s (95%)..."
"2","Inserting image 230 at 7.63s (95%)..."
"2","Inserting image 231 at 7.67s (96%)..."
"2","Inserting image 232 at 7.70s (96%)..."
"2","Inserting image 233 at 7.73s (97%)..."
"2","Inserting image 234 at 7.77s (97%)..."
"2","Inserting image 235 at 7.80s (97%)..."
"2","Inserting image 236 at 7.83s (98%)..."
"2","Inserting image 237 at 7.87s (98%)..."
"2","Inserting image 238 at 7.90s (99%)..."
"2","Inserting image 239 at 7.93s (99%)..."
"2","Inserting image 240 at 7.97s (100%)..."
"2","
Encoding to gif..."
"2"," done!
"
"0","anim_save(""figs/plot3_3v2.gif"") "
"0",""
"0","plot7 <- plot4 + plot6"
